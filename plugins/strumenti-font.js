let handler = async (m, { conn, command, text, usedPrefix }) => {
    let example = m.name || "samakavare";
    const totalFonts = 21;
    if ((command === 'font' && !text) || !text) {
        let styles = [];
        for (let i = 1; i <= totalFonts; i++) {
            styles.push(`*Font ${i}:* ${styleText(example, i)}`);
        }

        let buttons = [
            { buttonId: `${usedPrefix}fontrandom ${example}`, buttonText: { displayText: 'ðŸŽ² Font Random' }, type: 1 },
            { buttonId: `${usedPrefix}font1 ${example}`, buttonText: { displayText: 'ðŸ“ Font 1' }, type: 1 },
            { buttonId: `${usedPrefix}font5 ${example}`, buttonText: { displayText: 'âœ¨ Font 5' }, type: 1 }
        ];

        let buttonMessage = {
            text: `ã…¤ã…¤â‹†ï½¡Ëšã€Ž â•­ \`FONTS\` â•¯ ã€Ëšï½¡â‹†\nâ•­\nâ”‚
â”‚ ã€Ž ðŸ“ ã€ \`Esempio:\` 
â”‚ ${usedPrefix}font1 ${example}
â”‚ ${usedPrefix}fontrandom ${example}
â”‚
â”‚ ã€Ž ðŸŽ¨ ã€ \`Stili disponibili:\`
â”‚ ${styles.join('\nâ”‚ ')}
â”‚
â”‚ ã€Ž ðŸŽ² ã€ \`Comandi:\`
â”‚ ${usedPrefix}font[1-${totalFonts}] testo
â”‚ ${usedPrefix}fontrandom testo
*â•°â­’â”€×„â”€×…â”€×„â”€â­’â”€×„â”€×…â”€×„â”€*`,
            footer: 'âœ§ ð“¿ð“ªð“»ð“®ð“«ð“¸ð“½ âœ§',
            buttons: buttons,
            headerType: 1
        };
        
        return conn.sendMessage(m.chat, buttonMessage, { quoted: m });
    }

    let fontNumber;
    if (command === 'fontrandom' || (command === 'font' && text.toLowerCase() === 'random')) {
        fontNumber = Math.floor(Math.random() * totalFonts) + 1;
        if (text.toLowerCase() === 'random') text = example;
    } else {
        const cmdNum = command.replace(/[^0-9]/g, '');
        fontNumber = parseInt(cmdNum);
    }

    if (isNaN(fontNumber) || fontNumber < 1 || fontNumber > totalFonts) {
        return m.reply(`Per usare il comando digita ${usedPrefix}font <numero> <testo> oppure ${usedPrefix}font per la lista.`);
    }

    let result = styleText(text, fontNumber);
    
    let moreButtons = [
        { buttonId: `x`, buttonText: { displayText: `${result}` }, type: 1 },
        { buttonId: `${usedPrefix}fontrandom ${text}`, buttonText: { displayText: 'ðŸŽ² Altro Random' }, type: 1 },
        { buttonId: `${usedPrefix}font${fontNumber === totalFonts ? 1 : fontNumber + 1} ${text}`, buttonText: { displayText: `ðŸ“ Font ${fontNumber === totalFonts ? 1 : fontNumber + 1}` }, type: 1 }
    ];
    
    let resultMessage = {
        text: `ã€Ž ðŸŽ¨ \`Font ${fontNumber}\` ã€\n\n*${result}*`,
        footer: 'âœ§ ð“¿ð“ªð“»ð“®ð“«ð“¸ð“½ âœ§',
        buttons: moreButtons,
        headerType: 1
    };

    await conn.sendMessage(m.chat, resultMessage, { quoted: m });
};

function styleText(text, style) {
    const styles = {
        1: { 'a': 'á¥²', 'b': 'á‘²', 'c': 'á¥´', 'd': 'áƒ«', 'e': 'á¥±', 'f': 'ð–¿', 'g': 'g', 'h': 'Ò»', 'i': 'Ñ–', 'j': 'È·', 'k': 'k', 'l': 'á¥£', 'm': 'm', 'n': 'á¥’', 'o': 'á¥†', 'p': 'â´', 'q': 'ð—Š', 'r': 'r', 's': 's', 't': 'ð—', 'u': 'á¥™', 'v': 'á¥Ž', 'w': 'á¥•', 'x': 'á¥Š', 'y': 'á¥¡', 'z': 'z' },
        2: { 'a': 'ðš', 'b': 'ð›', 'c': 'ðœ', 'd': 'ð', 'e': 'ðž', 'f': 'ðŸ', 'g': 'ð ', 'h': 'ð¡', 'i': 'ð¢', 'j': 'ð£', 'k': 'ð¤', 'l': 'ð¥', 'm': 'ð¦', 'n': 'ð§', 'o': 'ð¨', 'p': 'ð©', 'q': 'ðª', 'r': 'ð«', 's': 'ð¬', 't': 'ð­', 'u': 'ð®', 'v': 'ð¯', 'w': 'ð°', 'x': 'ð±', 'y': 'ð²', 'z': 'ð³' },
        3: { 'a': 'ð“ª', 'b': 'ð“«', 'c': 'ð“¬', 'd': 'ð“­', 'e': 'ð“®', 'f': 'ð“¯', 'g': 'ð“°', 'h': 'ð“±', 'i': 'ð“²', 'j': 'ð“³', 'k': 'ð“´', 'l': 'ð“µ', 'm': 'ð“¶', 'n': 'ð“·', 'o': 'ð“¸', 'p': 'ð“¹', 'q': 'ð“º', 'r': 'ð“»', 's': 'ð“¼', 't': 'ð“½', 'u': 'ð“¾', 'v': 'ð“¿', 'w': 'ð”€', 'x': 'ð”', 'y': 'ð”‚', 'z': 'ð”ƒ' },
        4: { 'a': 'ð–†', 'b': 'ð–‡', 'c': 'ð–ˆ', 'd': 'ð–‰', 'e': 'ð–Š', 'f': 'ð–‹', 'g': 'ð–Œ', 'h': 'ð–', 'i': 'ð–Ž', 'j': 'ð–', 'k': 'ð–', 'l': 'ð–‘', 'm': 'ð–’', 'n': 'ð–“', 'o': 'ð–”', 'p': 'ð–•', 'q': 'ð––', 'r': 'ð–—', 's': 'ð–˜', 't': 'ð–™', 'u': 'ð–š', 'v': 'ð–›', 'w': 'ð–œ', 'x': 'ð–', 'y': 'ð–ž', 'z': 'ð–Ÿ' },
        5: { 'a': 'É‘××…', 'b': 'Ö®Ï×', 'c': 'á¯×Ö’', 'd': 'Õª××…ÝŠ', 'e': 'ê«€××…Ü»ÝŠ', 'f': 'Ü»â¨', 'g': 'á§×', 'h': 'h××…Ö®', 'i': 'êª±××××…×…×…', 'j': 'Õµ××…', 'k': 'Æ™××…', 'l': 'á¥£××…Öª', 'm': 'ê©‡××…ÖªÝŠ', 'n': 'ÝŠêª€', 'o': 'á¨µ××…×…', 'p': 'â„˜', 'q': 'q××…', 'r': 'ê­ˆ××…', 's': '×…ê¯±', 't': 't××…', 'u': 'Ï…××…', 'v': '××…á¥Ž××…', 'w': 'á¨°××…', 'x': 'á¥Š××…', 'y': 'á¨®××…Ö®', 'z': 'z××…Ö¬' },
        6: { 'a': 'ð•’', 'b': 'ð•“', 'c': 'ð•”', 'd': 'ð••', 'e': 'ð•–', 'f': 'ð•—', 'g': 'ð•˜', 'h': 'ð•™', 'i': 'ð•š', 'j': 'ð•›', 'k': 'ð•œ', 'l': 'ð•', 'm': 'ð•ž', 'n': 'ð•Ÿ', 'o': 'ð• ', 'p': 'ð•¡', 'q': 'ð•¢', 'r': 'ð•£', 's': 'ð•¤', 't': 'ð•¥', 'u': 'ð•¦', 'v': 'ð•§', 'w': 'ð•¨', 'x': 'ð•©', 'y': 'ð•ª', 'z': 'ð•«' },
        7: { 'a': 'ðŸ‡¦', 'b': 'ðŸ‡§', 'c': 'ðŸ‡¨', 'd': 'ðŸ‡©', 'e': 'ðŸ‡ª', 'f': 'ðŸ‡«', 'g': 'ðŸ‡¬', 'h': 'ðŸ‡­', 'i': 'ðŸ‡®', 'j': 'ðŸ‡¯', 'k': 'ðŸ‡°', 'l': 'ðŸ‡±', 'm': 'ðŸ‡²', 'n': 'ðŸ‡³', 'o': 'ðŸ‡´', 'p': 'ðŸ‡µ', 'q': 'ðŸ‡¶', 'r': 'ðŸ‡·', 's': 'ðŸ‡¸', 't': 'ðŸ‡¹', 'u': 'ðŸ‡º', 'v': 'ðŸ‡»', 'w': 'ðŸ‡¼', 'x': 'ðŸ‡½', 'y': 'ðŸ‡¾', 'z': 'ðŸ‡¿' },
        8: { 'a': 'ðŸ„°', 'b': 'ðŸ„±', 'c': 'ðŸ„²', 'd': 'ðŸ„³', 'e': 'ðŸ„´', 'f': 'ðŸ„µ', 'g': 'ðŸ„¶', 'h': 'ðŸ„·', 'i': 'ðŸ„¸', 'j': 'ðŸ„¹', 'k': 'ðŸ„º', 'l': 'ðŸ„»', 'm': 'ðŸ„¼', 'n': 'ðŸ„½', 'o': 'ðŸ„¾', 'p': 'ðŸ„¿', 'q': 'ðŸ…€', 'r': 'ðŸ…', 's': 'ðŸ…‚', 't': 'ðŸ…ƒ', 'u': 'ðŸ…„', 'v': 'ðŸ……', 'w': 'ðŸ…†', 'x': 'ðŸ…‡', 'y': 'ðŸ…ˆ', 'z': 'ðŸ…‰' },
        9: { 'a': 'ðŸ…', 'b': 'ðŸ…‘', 'c': 'ðŸ…’', 'd': 'ðŸ…“', 'e': 'ðŸ…”', 'f': 'ðŸ…•', 'g': 'ðŸ…–', 'h': 'ðŸ…—', 'i': 'ðŸ…˜', 'j': 'ðŸ…™', 'k': 'ðŸ…š', 'l': 'ðŸ…›', 'm': 'ðŸ…œ', 'n': 'ðŸ…', 'o': 'ðŸ…ž', 'p': 'ðŸ…Ÿ', 'q': 'ðŸ… ', 'r': 'ðŸ…¡', 's': 'ðŸ…¢', 't': 'ðŸ…£', 'u': 'ðŸ…¤', 'v': 'ðŸ…¥', 'w': 'ðŸ…¦', 'x': 'ðŸ…§', 'y': 'ðŸ…¨', 'z': 'ðŸ…©' },
        10: { 'a': 'á´€', 'b': 'Ê™', 'c': 'á´„', 'd': 'á´…', 'e': 'á´‡', 'f': 'Ò“', 'g': 'É¢', 'h': 'Êœ', 'i': 'Éª', 'j': 'á´Š', 'k': 'á´‹', 'l': 'ÊŸ', 'm': 'á´', 'n': 'É´', 'o': 'á´', 'p': 'á´˜', 'q': 'Ç«', 'r': 'Ê€', 's': 's', 't': 'á´›', 'u': 'á´œ', 'v': 'á´ ', 'w': 'á´¡', 'x': 'x', 'y': 'Ê', 'z': 'á´¢' },
        11: { 'a': 'ð˜¢', 'b': 'ð˜£', 'c': 'ð˜¤', 'd': 'ð˜¥', 'e': 'ð˜¦', 'f': 'ð˜§', 'g': 'ð˜¨', 'h': 'ð˜©', 'i': 'ð˜ª', 'j': 'ð˜«', 'k': 'ð˜¬', 'l': 'ð˜­', 'm': 'ð˜®', 'n': 'ð˜¯', 'o': 'ð˜°', 'p': 'ð˜±', 'q': 'ð˜²', 'r': 'ð˜³', 's': 'ð˜´', 't': 'ð˜µ', 'u': 'ð˜¶', 'v': 'ð˜·', 'w': 'ð˜¸', 'x': 'ð˜¹', 'y': 'ð˜º', 'z': 'ð˜»' },
        12: { 'a': 'ð™–', 'b': 'ð™—', 'c': 'ð™˜', 'd': 'ð™™', 'e': 'ð™š', 'f': 'ð™›', 'g': 'ð™œ', 'h': 'ð™', 'i': 'ð™ž', 'j': 'ð™Ÿ', 'k': 'ð™ ', 'l': 'ð™¡', 'm': 'ð™¢', 'n': 'ð™£', 'o': 'ð™¤', 'p': 'ð™¥', 'q': 'ð™¦', 'r': 'ð™§', 's': 'ð™¨', 't': 'ð™©', 'u': 'ð™ª', 'v': 'ð™«', 'w': 'ð™¬', 'x': 'ð™­', 'y': 'ð™®', 'z': 'ð™¯' },
        13: { 'a': 'ðšŠ', 'b': 'ðš‹', 'c': 'ðšŒ', 'd': 'ðš', 'e': 'ðšŽ', 'f': 'ðš', 'g': 'ðš', 'h': 'ðš‘', 'i': 'ðš’', 'j': 'ðš“', 'k': 'ðš”', 'l': 'ðš•', 'm': 'ðš–', 'n': 'ðš—', 'o': 'ðš˜', 'p': 'ðš™', 'q': 'ðšš', 'r': 'ðš›', 's': 'ðšœ', 't': 'ðš', 'u': 'ðšž', 'v': 'ðšŸ', 'w': 'ðš ', 'x': 'ðš¡', 'y': 'ðš¢', 'z': 'ðš£' },
        14: { 'a': 'Ã¡', 'b': 'b', 'c': 'Ã§', 'd': 'd', 'e': 'Ã©', 'f': 'f', 'g': 'g', 'h': 'h', 'i': 'Ã­', 'j': 'j', 'k': 'k', 'l': 'l', 'm': 'm', 'n': 'Ã±', 'o': 'Ã³', 'p': 'p', 'q': 'q', 'r': 'r', 's': 's', 't': 't', 'u': 'Ãº', 'v': 'v', 'w': 'w', 'x': 'x', 'y': 'Ã½', 'z': 'z' },
        15: { 'a': 'Î±', 'b': 'Ð²', 'c': 'Â¢', 'd': 'âˆ‚', 'e': 'Ñ”', 'f': 'Æ’', 'g': 'g', 'h': 'Ð½', 'i': 'Î¹', 'j': '× ', 'k': 'Ðº', 'l': 'â„“', 'm': 'Ð¼', 'n': 'Î·', 'o': 'Ïƒ', 'p': 'Ï', 'q': 'q', 'r': 'Ñ', 's': 'Ñ•', 't': 'Ñ‚', 'u': 'Ï…', 'v': 'Î½', 'w': 'Ï‰', 'x': 'Ï‡', 'y': 'Ñƒ', 'z': 'z' },
        16: { 'a': 'Ã„', 'b': 'ÃŸ', 'c': 'Ã‡', 'd': 'Ã', 'e': 'Ãˆ', 'f': 'Æ’', 'g': 'G', 'h': 'H', 'i': 'ÃŒ', 'j': 'J', 'k': 'K', 'l': 'L', 'm': 'M', 'n': 'Ã±', 'o': 'Ã–', 'p': 'Ã¾', 'q': 'Q', 'r': 'Â®', 's': 'Â§', 't': 'â€ ', 'u': 'Ãœ', 'v': 'V', 'w': 'W', 'x': 'X', 'y': 'Â¥', 'z': 'Z' },
        17: { 'a': 'â“', 'b': 'â“‘', 'c': 'â“’', 'd': 'â““', 'e': 'â“”', 'f': 'â“•', 'g': 'â“–', 'h': 'â“—', 'i': 'â“˜', 'j': 'â“™', 'k': 'â“š', 'l': 'â“›', 'm': 'â“œ', 'n': 'â“', 'o': 'â“ž', 'p': 'â“Ÿ', 'q': 'â“ ', 'r': 'â“¡', 's': 'â“¢', 't': 'â“£', 'u': 'â“¤', 'v': 'â“¥', 'w': 'â“¦', 'x': 'â“§', 'y': 'â“¨', 'z': 'â“©' },
        18: { 'a': 'ðŸ…°', 'b': 'ðŸ…±', 'c': 'ðŸ…²', 'd': 'ðŸ…³', 'e': 'ðŸ…´', 'f': 'ðŸ…µ', 'g': 'ðŸ…¶', 'h': 'ðŸ…·', 'i': 'ðŸ…¸', 'j': 'ðŸ…¹', 'k': 'ðŸ…º', 'l': 'ðŸ…»', 'm': 'ðŸ…¼', 'n': 'ðŸ…½', 'o': 'ðŸ…¾', 'p': 'ðŸ…¿', 'q': 'ðŸ†€', 'r': 'ðŸ†', 's': 'ðŸ†‚', 't': 'ðŸ†ƒ', 'u': 'ðŸ†„', 'v': 'ðŸ†…', 'w': 'ðŸ††', 'x': 'ðŸ†‡', 'y': 'ðŸ†ˆ', 'z': 'ðŸ†‰' },
        19: { 'a': 'á—©', 'b': 'á—·', 'c': 'á‘•', 'd': 'á—ª', 'e': 'E', 'f': 'á–´', 'g': 'G', 'h': 'á•¼', 'i': 'I', 'j': 'á’', 'k': 'K', 'l': 'á’ª', 'm': 'á—°', 'n': 'á‘Ž', 'o': 'O', 'p': 'á‘­', 'q': 'á‘«', 'r': 'á–‡', 's': 'á”•', 't': 'T', 'u': 'á‘Œ', 'v': 'á¯', 'w': 'á—¯', 'x': 'á™­', 'y': 'Y', 'z': 'á˜”' },
        20: { 'a': 'à¸„', 'b': 'à¹’', 'c': 'Ï‚', 'd': 'à¹”', 'e': 'Ñ”', 'f': 'Å¦', 'g': 'ï»®', 'h': 'Ñ’', 'i': 'à¹€', 'j': '×Ÿ', 'k': 'Ðº', 'l': 'É­', 'm': 'à¹“', 'n': 'à¸ ', 'o': 'à¹', 'p': '×§', 'q': 'á»£', 'r': 'Ð³', 's': 'à¸£', 't': 'Õ‡', 'u': 'à¸¢', 'v': '×©', 'w': 'à¸¬', 'x': '×', 'y': '×¥', 'z': 'Õ¹' },
        21: { 'a': 'Î›', 'b': 'B', 'c': 'á„ƒ', 'd': 'D', 'e': 'Î£', 'f': 'F', 'g': 'G', 'h': 'H', 'i': 'I', 'j': 'J', 'k': 'K', 'l': 'L', 'm': 'M', 'n': 'N', 'o': 'Ó¨', 'p': 'P', 'q': 'Q', 'r': 'Ð¯', 's': 'S', 't': 'T', 'u': 'Ð¦', 'v': 'V', 'w': 'W', 'x': 'X', 'y': 'Y', 'z': 'Z' }
    };

    return text.split('').map(char => {
        const lower = char.toLowerCase();
        if (styles[style] && styles[style][lower]) {
            return styles[style][lower];
        }
        return char;
    }).join('');
}

handler.help = ['font [1-21] <testo>', 'fontrandom <testo>'];
handler.tags = ['strumenti'];
handler.command = ['font', /^(font)(1[0-9]|2[0-1]|[1-9]|random)$/i];

export default handler;